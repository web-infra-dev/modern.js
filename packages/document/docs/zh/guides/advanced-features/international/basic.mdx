---
title: åŸºç¡€æ¦‚å¿µ
---

# åŸºç¡€æ¦‚å¿µ

åœ¨é¡¹ç›®é›†æˆå›½é™…åŒ–èƒ½åŠ›ä¹‹å‰ï¼Œéœ€è¦äº†è§£å›½é™…åŒ–ç›¸å…³æ¦‚å¿µã€‚ç†è§£æ ¸å¿ƒæ¦‚å¿µå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿå»ºç«‹ç¨³å®šçš„ç¿»è¯‘ä½“ç³»ï¼Œå¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è§£å†³ä½¿ç”¨è¿‡ç¨‹ä¸­çš„å„ç§é—®é¢˜ã€‚

## æ ¸å¿ƒæ¦‚å¿µ

### i18n

`i18n` æ˜¯ Internationalization çš„ç¼©å†™ï¼ŒæŒ‡è®©åº”ç”¨åœ¨ä¸åŒè¯­è¨€ã€åœ°åŒºå’Œæ–‡åŒ–ä¸­éƒ½èƒ½è‰¯å¥½è¿è¡Œï¼Œéœ€è¦åœ¨è®¾è®¡é˜¶æ®µå°±è€ƒè™‘å¤šè¯­è¨€èµ„æºã€æ•°å­—/æ—¥æœŸ/è´§å¸ä»¥åŠæ–‡åŒ–å·®å¼‚ç­‰å› ç´ ã€‚

### i18next

i18next æ˜¯ä¸€ä¸ªé€šç”¨çš„å›½é™…åŒ–æ¡†æ¶ï¼Œæä¾›è¯­è¨€æ£€æµ‹ã€èµ„æºç®¡ç†ã€æ’å€¼ã€å¤æ•°ç­‰èƒ½åŠ›ã€‚@modern-js/plugin-i18n é»˜è®¤åŸºäº i18nextï¼Œè¯·å‚è€ƒå…¶[å®˜æ–¹æ–‡æ¡£](https://www.i18next.com/)è·å–å®Œæ•´çš„é…ç½®è¯´æ˜ã€‚

### react-i18next

react-i18next æ˜¯ i18next çš„ React ç»‘å®šåº“ï¼Œæä¾› `useTranslation`ã€`Trans` ç­‰ Hook/ç»„ä»¶ï¼Œå®ç°ä¸ React ç”Ÿå‘½å‘¨æœŸè‰¯å¥½ç»“åˆï¼š

```tsx
import { useTranslation } from 'react-i18next';

function App() {
  const { t } = useTranslation();
  return <h1>{t('welcome')}</h1>;
}
```

### i18n å®ä¾‹

i18next é»˜è®¤å¯¼å‡ºä¸€ä¸ªå®ä¾‹ï¼Œä¹Ÿæ”¯æŒé€šè¿‡ `createInstance` ç”Ÿæˆå¤šå®ä¾‹ï¼š

```ts
import i18next, { createInstance } from 'i18next';

i18next.init({
  /* ... */
});

const custom = createInstance();
await custom.init({
  /* ç‹¬ç«‹é…ç½® */
});
```

å®ä¾‹è´Ÿè´£ç¿»è¯‘èµ„æºã€å½“å‰è¯­è¨€ã€åˆ‡æ¢è¯­è¨€ç­‰åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥åœ¨ Modern.js çš„ `runtime` ä¸­ä¼ å…¥è‡ªå®šä¹‰å®ä¾‹ã€‚

### åˆå§‹åŒ–ï¼ˆinitï¼‰

i18next é€šè¿‡ `init` å®Œæˆåˆå§‹åŒ–ï¼Œå¸¸ç”¨æ ¸å¿ƒé€‰é¡¹ï¼š

- `lng`ï¼šåˆå§‹è¯­è¨€
- `ns` / `defaultNS`ï¼šå‘½åç©ºé—´åˆ—è¡¨ä¸é»˜è®¤å‘½åç©ºé—´
- `supportedLngs`ï¼šå…è®¸çš„è¯­è¨€é›†åˆ
- `fallbackLng`ï¼šç¼ºå¤±èµ„æºæ—¶çš„å›é€€è¯­è¨€ï¼ˆå¯ä¸ºæ•°ç»„æˆ–æ˜ å°„ï¼‰
- `interpolation`ï¼šæ’å€¼è®¾ç½®ï¼ŒReact ç¯å¢ƒé€šå¸¸é…ç½® `escapeValue: false`

```ts
i18next.init({
  lng: 'zh',
  ns: ['translation', 'common'],
  defaultNS: 'translation',
  supportedLngs: ['zh', 'en'],
  fallbackLng: ['en'],
  interpolation: { escapeValue: false },
});
```

### `t` å‡½æ•°

`t` æ˜¯è·å–ç¿»è¯‘çš„æ ¸å¿ƒ APIï¼Œå¯ç›´æ¥ä»å®ä¾‹ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ react-i18next Hook è·å¾—ï¼š

```ts
i18next.t('welcome');
```

```tsx
const { t } = useTranslation();
t('welcome', { name: 'Modern.js', count: 3 });
```

`t` æ”¯æŒæ’å€¼ã€å¤æ•°ã€ä¸Šä¸‹æ–‡ç­‰é«˜çº§ç‰¹æ€§ï¼Œåæ–‡ä¼šå±•å¼€è¯´æ˜ã€‚

import PlatformSupport from '@site-docs/components/international/platform-support';

<PlatformSupport />

## è¯­è¨€ä»£ç 

è¯­è¨€ä»£ç ç”¨äºæ ‡è¯†å½“å‰ç•Œé¢è¯­è¨€ï¼Œéµå¾ª ISO 639-1 æ ‡å‡†ï¼ˆ`en`ã€`zh` ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥æºå¸¦åœ°åŒºä¿¡æ¯ï¼ˆ`en-US`ã€`zh-CN`ï¼‰ã€‚

- **æ”¯æŒè¯­è¨€åˆ—è¡¨**ï¼šé€šè¿‡æ’ä»¶é…ç½®å£°æ˜ï¼Œç¼–è¯‘æœŸå³å¯è·çŸ¥éœ€è¦ç”Ÿæˆçš„äº§ç‰©ã€‚
- **é»˜è®¤è¯­è¨€**ï¼šå½“æ£€æµ‹ä¸åˆ°ç”¨æˆ·è¯­è¨€æˆ–èµ„æºç¼ºå¤±æ—¶ä½¿ç”¨ã€‚
- **å›é€€è¯­è¨€é“¾**ï¼š`en-US â†’ en â†’ zh` è¿™ç±»é“¾å†³å®šç¼ºå¤±ç¿»è¯‘æ—¶çš„æŸ¥æ‰¾é¡ºåºã€‚

```ts
// modern.config.ts
import { defineConfig } from '@modern-js/app-tools';
import { i18nPlugin } from '@modern-js/plugin-i18n';

export default defineConfig({
  plugins: [
    i18nPlugin({
      localeDetection: {
        languages: ['zh', 'en', 'ja'],
        fallbackLanguage: ['zh', 'en'], // æ”¯æŒå›é€€é“¾
      },
    }),
  ],
});
```

ğŸ’¡ å»ºè®®å°† `supportedLanguages` ä¸ `fallbackLanguage` åŒæ­¥ç»´æŠ¤ï¼Œé¿å…å‡ºç°ç”¨æˆ·åˆ‡æ¢åˆ°æœªé…ç½®è¯­è¨€çš„æƒ…å†µã€‚

## å‘½åç©ºé—´

å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ç”¨äºæŒ‰ç…§ä¸šåŠ¡æ¨¡å—æ‹†åˆ†ç¿»è¯‘æ–‡ä»¶ï¼Œä¾¿äºä»£ç åˆ†å‰²ä¸æŒ‰éœ€åŠ è½½ã€‚æœªæŒ‡å®šæ—¶ä½¿ç”¨é»˜è®¤å‘½åç©ºé—´ `translation`ã€‚

```ts
// src/modern.runtime.ts
import { defineRuntimeConfig } from '@modern-js/runtime';

export default defineRuntimeConfig({
  i18n: {
    initOptions: {
      ns: ['translation', 'common', 'dashboard'],
      defaultNS: 'translation',
    },
  },
});
```

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ä¸åŒå‘½åç©ºé—´ï¼š

```tsx
import { useTranslation } from 'react-i18next';

export function DashboardHeader() {
  const { t } = useTranslation(['dashboard', 'common']);
  return (
    <header>
      <h1>{t('dashboard:title')}</h1>
      <button>{t('common:button.refresh')}</button>
    </header>
  );
}
```

å‘½åç©ºé—´è¿˜å¯ä»¥å’ŒåŠ¨æ€åŠ è½½ç»“åˆï¼ŒæŒ‰éœ€è¯·æ±‚å¤§ä½“é‡æ–‡æ¡ˆã€‚

## èµ„æºæ–‡ä»¶ç»“æ„

æ¨èçš„èµ„æºæ–‡ä»¶ç›®å½•ï¼š

```
locales/
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ translation.json
â”‚   â”œâ”€â”€ common.json
â”‚   â””â”€â”€ dashboard.json
â””â”€â”€ zh/
    â”œâ”€â”€ translation.json
    â”œâ”€â”€ common.json
    â””â”€â”€ dashboard.json
```

- **æ–‡ä»¶å‘½å**ï¼š`locales/<language>/<namespace>.json`
- **æ ¼å¼**ï¼šæ ‡å‡† JSONï¼Œé”®å€¼å¯¹æˆ–åµŒå¥—å¯¹è±¡
- **ç»„ç»‡**ï¼šåµŒå¥—å¯¹è±¡ç”¨äºè¡¨ç¤º UI å±‚çº§ï¼Œä¾‹å¦‚æŒ‰é’®ã€å¯¹è¯æ¡†ç­‰

```json
{
  "header": {
    "title": "æ¬¢è¿",
    "actions": {
      "save": "ä¿å­˜",
      "cancel": "å–æ¶ˆ"
    }
  }
}
```

ä¹Ÿå¯ä»¥é€šè¿‡ `resources` é€‰é¡¹åœ¨åˆå§‹åŒ–æ—¶ç›´æ¥æ³¨å…¥èµ„æºï¼Œæˆ–åœ¨è¿è¡Œæ—¶è°ƒç”¨ `addResourceBundle`ï¼š

```ts
i18next.init({
  resources: {
    en: {
      common: {
        welcome: 'Welcome',
      },
    },
    zh: {
      common: {
        welcome: 'æ¬¢è¿',
      },
    },
  },
});

i18next.addResourceBundle('en', 'home', { title: 'Home' });
```

## ç¿»è¯‘é”®

ç¿»è¯‘é”®ï¼ˆTranslation Keyï¼‰æ˜¯è®¿é—®ç¿»è¯‘çš„è·¯å¾„ï¼Œé€šå¸¸ä½¿ç”¨ç‚¹å·è¡¨ç¤ºå±‚çº§ï¼š`common.button.submit`ã€‚

å‘½åè§„èŒƒå»ºè®®ï¼š

- ä½¿ç”¨è¯­ä¹‰åŒ–å•è¯ï¼Œé¿å…ç¼©å†™
- æŒ‰æ¨¡å—åˆ’åˆ†å‰ç¼€ï¼ˆ`dashboard.table.*`ï¼‰
- å¯ä½¿ç”¨ `:` æŒ‡å®šå‘½åç©ºé—´ï¼ˆ`common:button.submit`ï¼‰
- é¿å…ç›´æ¥æŠŠå®Œæ•´ä¸­æ–‡æ–‡æ¡ˆå½“ä½œé”®

```tsx
const { t } = useTranslation();

button.textContent = t('common.button.submit', {
  defaultValue: 'Submit',
});
```

## æ’å€¼å’Œå˜é‡

æ’å€¼ï¼ˆInterpolationï¼‰å…è®¸åœ¨ç¿»è¯‘æ–‡æœ¬ä¸­åŠ¨æ€æ³¨å…¥å˜é‡ã€‚

**èµ„æºæ–‡ä»¶**ï¼š

```json
{
  "welcome": "æ¬¢è¿ï¼Œ{{name}}ï¼",
  "invite": "{{name}} é‚€è¯·ä½ åŠ å…¥ {{project}}",
  "formattedValue": "å½“å‰ä»·æ ¼ï¼š{{value, currency}}"
}
```

**ç”¨æ³•**ï¼š

```tsx
const { t } = useTranslation();

return (
  <>
    <p>{t('welcome', { name: 'John' })}</p>
    <p>{t('invite', { name: 'Alice', project: 'Modern.js' })}</p>
  </>
);
```

### åµŒå¥—æ’å€¼

å¯ä»¥ç›´æ¥ä¼ é€’å¯¹è±¡æˆ–å¤šçº§å˜é‡ï¼š

```json
{
  "greeting": "ä½ å¥½ï¼Œ{{user.name}}ï¼Œä½ æœ‰ {{user.notifications}} æ¡æ–°æ¶ˆæ¯"
}
```

```tsx
t('greeting', {
  user: { name: 'Jay', notifications: 3 },
});
```

### æ ¼å¼åŒ–æ’å€¼

é€šè¿‡ `interpolation.format` å‡½æ•°æ ¼å¼åŒ–æ•°å­—ã€æ—¥æœŸç­‰ï¼š

```ts
export default defineRuntimeConfig({
  i18n: {
    initOptions: {
      interpolation: {
        format(value, format, lng) {
          if (format === 'currency') {
            return new Intl.NumberFormat(lng, {
              style: 'currency',
              currency: lng === 'zh' ? 'CNY' : 'USD',
            }).format(Number(value));
          }
          if (value instanceof Date) {
            return new Intl.DateTimeFormat(lng, { dateStyle: 'medium' }).format(
              value,
            );
          }
          return value;
        },
      },
    },
  },
});
```

```tsx
t('formattedValue', { value: 99.5, format: 'currency' });
```

### è½¬ä¹‰æ’å€¼

`react-i18next` é»˜è®¤ä¼šå¯¹æ’å€¼å€¼è¿›è¡Œè½¬ä¹‰ä»¥é˜²æ­¢ XSSã€‚å¦‚éœ€æ¸²æŸ“å®‰å…¨çš„ HTMLï¼Œéœ€æ˜¾å¼å¼€å¯ `interpolation.escapeValue = false` å¹¶ç¡®ä¿æ•°æ®å¯ä¿¡ã€‚

## å¤æ•°

å¤æ•°å¤„ç†æ ¹æ®è¯­è¨€è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„è¯å½¢ï¼Œä¾èµ– `count` å‚æ•°ã€‚

```json
{
  "item": "1 ä¸ªæ¡ç›®",
  "item_plural": "{{count}} ä¸ªæ¡ç›®",
  "item_0": "æ²¡æœ‰æ¡ç›®"
}
```

```tsx
t('item', { count: 0 }); // æ²¡æœ‰æ¡ç›®
t('item', { count: 1 }); // 1 ä¸ªæ¡ç›®
t('item', { count: 5 }); // 5 ä¸ªæ¡ç›®
```

ä¸åŒè¯­è¨€å…·æœ‰ä¸åŒçš„å¤æ•°è§„åˆ™ï¼Œä¾‹å¦‚ï¼š

- **è‹±è¯­**ï¼šå•æ•°ã€å¤æ•°
- **ä¿„è¯­**ï¼šoneã€fewã€many å¤šç§å½¢å¼
- **ä¸­æ–‡**ï¼šé€šå¸¸åªæœ‰å•ä¸€å½¢å¼ï¼Œå¯ä½¿ç”¨ `_0` é”®è¦†ç›–ç‰¹æ®Šæ–‡æ¡ˆ

ğŸ’¡ å¦‚æœéœ€è¦è‡ªå®šä¹‰å¤æ•°è§„åˆ™ï¼Œå¯é€šè¿‡ `i18next.services.pluralResolver` æ‰©å±•ï¼Œè¯¦è§é«˜çº§ç”¨æ³•ã€‚

## åµŒå¥—ç¿»è¯‘ç»“æ„

åµŒå¥—ç»“æ„å¯ä»¥ç›´è§‚åæ˜  UI å±‚çº§ã€‚

```json
{
  "common": {
    "button": {
      "submit": "æäº¤",
      "cancel": "å–æ¶ˆ"
    }
  }
}
```

åœ¨ä»£ç ä¸­ä½¿ç”¨ç‚¹å·è®¿é—®ï¼š

```tsx
const { t } = useTranslation();
t('common.button.submit');
```

åµŒå¥—ç»“æ„çš„ä¼˜åŠ¿ï¼š

- é¿å…é”®åå†—é•¿
- ä¾¿äºåœ¨ JSON ä¸­æ•´ä½“æŸ¥çœ‹æ¨¡å—æ–‡æ¡ˆ
- å¯æ­é… `keyPrefix` ç²¾ç®€è°ƒç”¨ï¼š`useTranslation('common', { keyPrefix: 'button' })`

## å›é€€è¯­è¨€

å½“å½“å‰è¯­è¨€ç¼ºå°‘æŸä¸ªé”®æ—¶ï¼Œä¼šæŒ‰å›é€€è¯­è¨€é“¾ç»§ç»­æŸ¥æ‰¾ã€‚

```ts
export default defineRuntimeConfig({
  i18n: {
    initOptions: {
      lng: 'zh-CN',
      fallbackLng: {
        'zh-CN': ['zh', 'en'],
        default: ['en'],
      },
    },
  },
});
```

:::tip
å¯ä»¥å°†åœ°åŒºè¯­è¨€ï¼ˆå¦‚ `zh-CN`ï¼‰å›é€€åˆ°é€šç”¨è¯­è¨€ï¼ˆ`zh`ï¼‰ï¼Œæœ€åå†å›é€€åˆ°é»˜è®¤è¯­è¨€ï¼ˆ`en`ï¼‰ï¼Œç¡®ä¿æ‰€æœ‰é”®éƒ½æœ‰å¯ç”¨æ–‡æœ¬ã€‚
:::

## è¯­è¨€æ£€æµ‹

i18next é€šè¿‡è¯­è¨€æ£€æµ‹æ’ä»¶è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·è¯­è¨€ï¼ŒModern.js æ’ä»¶å†…ç½®æµè§ˆå™¨ä¸æœåŠ¡ç«¯æ”¯æŒã€‚

```ts
import LanguageDetector from 'i18next-browser-languagedetector';
import i18next from 'i18next';

i18next.use(LanguageDetector).init({
  supportedLngs: ['zh', 'en', 'ja'],
  detection: {
    order: ['path', 'cookie', 'localStorage', 'navigator'],
    lookupCookie: 'i18next',
    lookupLocalStorage: 'i18nextLng',
  },
});
```

Modern.js ä¸­å¯ä»¥ç›´æ¥åœ¨æ’ä»¶é…ç½®é‡Œå¼€å¯å†…ç½®æ£€æµ‹ï¼š

```ts
i18nPlugin({
  localeDetection: {
    i18nextDetector: true,
    languages: ['zh', 'en'],
    detection: {
      order: ['path', 'cookie', 'header'],
    },
  },
});
```

:::warning
å¯ç”¨æ£€æµ‹åï¼Œæ— éœ€åœ¨ `init` ä¸­æ˜¾å¼è®¾ç½® `lng`ã€‚å¦‚æœæ‰‹åŠ¨è°ƒç”¨ `changeLanguage()` æœªä¼ å…¥è¯­è¨€ï¼Œä¹Ÿä¼šæ ¹æ®æ£€æµ‹é…ç½®è‡ªåŠ¨æ¨æ–­ã€‚
:::
