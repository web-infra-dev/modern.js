---
sidebar_label: proxy
---

# bff.proxy

- **Type:** `Record<string, string>`
- **Default:** `{}`

:::caution
Please enable BFF functionality in the current application project root directory using [new](/apis/app/commands#modern-new) first.

:::

With simple configuration, Modern.js can automatically proxy requests sent to the BFF server to the specified service.

BFF Proxy uses the powerful [http-proxy-middleware](https://github.com/chimurai/http-proxy-middleware). For more advanced usage, please refer to its [documentation](https://github.com/chimurai/http-proxy-middleware#options).

Add the following configuration to `modern.server-runtime.config.js` to enable proxy:

```ts title="modern.server-runtime.config.ts"
import { defineConfig } from '@modern-js/app-tools/server';
export default defineConfig({
  bff: {
    proxy: {
      '/api': 'https://cnodejs.org',
    },
  },
});
```

Assuming the address of Modern.js BFF server is `localhost:8080`, all requests starting with `api` will be proxied to `https://cnodejs.org`, for example, the request to `localhost:8080/api/v1/topics` will be proxied to `https://cnodejs.org/api/v1/topics`.

Path rewriting can also be performed here, such as proxying the request sent to `localhost:8080/api/topics` to `https://cnodejs.org/api/v1/topics`.

```js title="modern.server-runtime.config.js"
import { defineConfig } from '@modern-js/app-tools/server';
export default defineConfig({
  bff: {
    proxy: {
      '/api': {
        target: 'https://cnodejs.org',
        pathRewrite: { '/api/topics': '/api/v1/topics' },
        changeOrigin: true,
      },
    },
  },
});
```

Unlike [dev.proxy](/configure/app/dev/proxy), the proxy here only applies to requests entering the BFF/API service; at the same time, this configuration can not only be used in the development environment, but also proxies corresponding requests in the production environment.

## Common Usage

### Solving Cross-Domain Issues for APIs

During project development, cross-domain issues are often encountered because web pages and API services are not deployed under the same domain name.
There are many ways to solve cross-domain issues, and here we can easily solve them using `bff.proxy`.

:::info
Under BFF proxy mode, if you don't need to write BFF code, the API directory can be deleted; BFF proxy will still be enabled.

:::

As shown below, the following configuration in `modern.server-runtime.config.ts` will proxy all web page requests starting with `/api` to a service on another domain with the same domain.

```ts title="modern.server-runtime.config.ts"
export default defineServerConfig({
  bff: {
    proxy: {
      '/api': 'https://cnodejs.org',
    },
  },
};
```
