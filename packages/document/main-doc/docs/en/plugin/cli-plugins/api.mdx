# CLI Plugin API

# Modern.js CLI Plugin API

This document details the API for Modern.js CLI plugins. CLI plugins allow you to extend and customize the functionality of Modern.js projects during the build and development process.

## Plugin Basic Structure

A typical CLI plugin structure is as follows:

```typescript
import type { CliPluginFuture, AppTools } from '@modern-js/app-tools';

const myCliPlugin = (): CliPluginFuture<AppTools<'shared'>> => ({
  name: '@my-org/my-plugin', // Plugin name, ensure uniqueness
  setup: (api) => {
    // Use the API here to register hooks, add commands, etc.
    api.onBeforeBuild(() => {
      console.log('Build is about to start...');
    });
  },
});

export default myCliPlugin;
```

The `setup` function receives an `api` object, which provides all available CLI plugin APIs.

## API Reference

### Information Retrieval

#### `api.getAppContext`

Gets the context information of the Modern.js application.

-   **Returns:** An `AppContext` object containing the following fields:

| Field Name             | Type                 | Description                                                                   | When Available                         |
| ---------------------- | -------------------- | ----------------------------------------------------------------------------- | -------------------------------------- |
| `command`              | `string`             | The currently executing command (e.g., `dev`, `build`, `deploy`)              | -                                   |
| `port`                 | `number`             | The development server port number                                             | After `onPrepare`                       |
| `configFile`           | `string`             | The absolute path to the configuration file                                   | -                                   |
| `isProd`               | `boolean`            | Whether it is in production mode                                              | -                                   |
| `appDirectory`         | `string`             | The absolute path to the project root directory                               | -                                   |
| `srcDirectory`         | `string`             | The absolute path to the project source code directory                        | -                                   |
| `distDirectory`        | `string`             | The absolute path to the project output directory                             | After `modifyResolvedConfig`              |
| `sharedDirectory`      | `string`             | The absolute path to the shared modules directory                             | -                                   |
| `internalDirectory`    | `string`             | The absolute path to the framework's internal temporary output directory       | -                                   |
| `nodeModulesDirectory` | `string`             | The absolute path to the `node_modules` directory                              | -                                   |
| `ip`                   | `string`             | The IPv4 address of the current machine                                       | -                                   |
| `packageName`          | `string`             | The `name` field in the project's `package.json`                               | -                                   |
| `plugins`              | `object[]`           | The list of currently registered plugins                                     | -                                   |
| `entrypoints`          | `object[]`           | Information about page entry points                                           | -                                   |
| `serverRoutes`         | `object[]`           | Server-side routing information                                               | -                                   |
| `bundlerType`          | `webpack \| rspack` | The type of bundler currently in use (`webpack` or `rspack`)                   | After `onPrepare`                       |
| `metaName`             | `string`             | The internal name of the framework                                            | -                                   |
| `apiDirectory`         | `string`             | The absolute path to the API module directory (used by BFF)                   | -                                   |
| `lambdaDirectory`      | `string`             | The absolute path to the Lambda module directory (used by BFF)                | -                                   |
| `runtimeConfigFile`    | `string`             | The name of the runtime configuration file                                    | -                                   |
| `serverConfigFile`     | `string`             | The name of the server configuration file                                     | -                                   |
| `checkedEntries`       | `string[]`           | Specified entry information                                                   | -                                   |
| `apiOnly`              | `boolean`            | Whether it is in `apiOnly` mode                                               | -                                   |
| `internalDirAlias`     | `string`             | Alias for the framework's internal temporary output directory                  | -                                   |
| `internalSrcAlias`     | `string`             | Alias for the framework's `src` directory                                     | -                                   |

-   **Example:**

```typescript
api.onPrepare(() => {
  const appContext = api.getAppContext();
  console.log(`The current project is running in ${appContext.isProd ? 'production' : 'development'} mode`);
  console.log(`Bundler: ${appContext.bundlerType}`);
});
```

---

#### `api.getConfig`

Gets the user-defined configuration from the `modern.config.ts` file.

-   **Returns:** The user-defined configuration object.
-   **Example:**

```typescript
api.onPrepare(() => {
    const userConfig = api.getConfig();
    if (userConfig.output) {
        console.log('User has customized the output configuration');
    }
});

```

---

#### `api.getNormalizedConfig`

Gets the final configuration after internal processing by Modern.js and modifications by plugins (normalized configuration).

-   **Returns:** The normalized configuration object.
-   **When Available:** Must be used after the `modifyResolvedConfig` hook.
-   **Example:**

```typescript
api.modifyResolvedConfig(resolvedConfig => {
  // ... Modify the configuration ...
  return resolvedConfig;
});

api.onBeforeBuild(() => {
  const finalConfig = api.getNormalizedConfig();
  console.log('Final build configuration:', finalConfig);
});
```

---

#### `api.isPluginExists`

Checks if a specified plugin is registered.

-   **Parameters:**
    -   `pluginName: string`: The name of the plugin to check.
-   **Returns:** A `boolean` value indicating whether the plugin exists.
-   **Example:**

```typescript
if (api.isPluginExists('@modern-js/plugin-tailwind')) {
  console.log('Tailwind CSS plugin is enabled');
}
```

---

#### `api.getHooks`

Gets all registered hook functions.

-   **Returns:** An object containing all hook functions.
-   **Example:**

```typescript
const hooks = api.getHooks();
// Manually trigger the onPrepare hook
hooks.onPrepare.call();
```

---

### Configuration Modification

#### `api.config`

Registers a function to modify the initial configuration of Modern.js.

-   **Type:**  `api.config(configFn: () => UserConfig | Promise<UserConfig>)`
-   **Parameters:**
    -   `configFn`: A function that returns a configuration object or a Promise.
-   **Execution Phase:** After parsing the configuration in `modern.config.ts`.
-   **Example:**

```typescript
api.config(() => {
  return {
    output: {
      disableTsChecker: true, // Disable TypeScript type checking
    },
  };
});
```

**Configuration Merge Priority** (highest to lowest):

1.  User-defined configuration in the `modern.config.*` file.
2.  Configuration registered by plugins via `api.config()`.
3.  Modern.js default configuration.

---

#### `modifyBundlerChain`

Registers a function to modify the webpack or Rspack configuration using the chain API.

- **Type:** `api.modifyBundlerChain(modifyFn: (chain: WebpackChain | RspackChain, utils: WebpackUtils | RspackUtils) => void | Promise<void>)`
- **Parameters:**
  - `modifyFn`: A modification function that receives a `webpack-chain` or `RspackChain` instance and utility functions as parameters.
- **Execution Phase:** When generating the final Webpack or Rspack configuration.
- **Corresponding Rsbuild Hook**: [modifyBundlerChain](https://rsbuild.dev/en/plugins/dev/hooks#modifybundlerchain)
- **Example:**

```typescript
api.modifyBundlerChain((chain, utils) => {
  if (utils.env === 'development') {
    chain.devtool('eval');
  }
  chain.plugin('bundle-analyze').use(BundleAnalyzerPlugin);
});
```

#### `api.modifyRsbuildConfig`

Registers a function to modify the Rsbuild configuration.

-   **Type:**  `api.modifyRsbuildConfig(modifyFn: (config: RsbuildConfig, utils: RsbuildUtils) => RsbuildConfig | Promise<RsbuildConfig> | void)`
-   **Parameters:**
    -   `modifyFn`: A modification function that receives the Rsbuild configuration object and utility functions as parameters.  It can return a modified configuration object, a Promise, or nothing (modifying the original object directly).
-   **Execution Phase:** When generating the final Rsbuild configuration.
-   **Corresponding Rsbuild Hook**: [modifyRsbuildConfig](https://rsbuild.dev/en/plugins/dev/hooks#modifyrsbuildconfig)
-   **Example:**

```typescript
api.modifyRsbuildConfig((config, utils) => {
  // Add a custom Rsbuild plugin
  config.plugins.push(myCustomRsbuildPlugin());
});

```
---

#### `api.modifyRspackConfig`

Registers a function to modify the Rspack configuration (when Rspack is used as the bundler).

-   **Type:**  `api.modifyRspackConfig(modifyFn: (config: RspackConfig, utils: RspackUtils) => RspackConfig | Promise<RspackConfig> | void)`
-   **Parameters:**
    -   `modifyFn`: A modification function that receives the Rspack configuration object and utility functions as parameters.  It can return a modified configuration object, a Promise, or nothing (modifying the original object directly).
-   **Execution Phase:** When generating the final Rspack configuration.
-   **Corresponding Rsbuild Hook**: [modifyRspackConfig](https://rsbuild.dev/en/plugins/dev/hooks#modifyrspackconfig)
-   **Example:**

```typescript
api.modifyRspackConfig((config, utils) => {
  config.builtins.minify = {
      enable: true,
      implementation: utils.rspack.SwcJsMinimizerRspackPlugin,
  }
});
```

---

#### `api.modifyWebpackChain`

Registers a function to modify the Webpack configuration using [webpack-chain](https://github.com/neutrinojs/webpack-chain) (when Webpack is used as the bundler).

-   **Type:**  `api.modifyWebpackChain(modifyFn: (chain: WebpackChain, utils: WebpackUtils) => void | Promise<void>)`
-   **Parameters:**
    -   `modifyFn`: A modification function that receives a `webpack-chain` instance and utility functions as parameters.
-   **Execution Phase:** When generating the final Webpack configuration.
-   **Example:**

```typescript
api.modifyWebpackChain((chain, utils) => {
  // Add a custom Webpack loader
  chain.module
    .rule('my-loader')
    .test(/\.my-ext$/)
    .use('my-loader')
    .loader(require.resolve('./my-loader'));
});
```

---

#### `api.modifyWebpackConfig`

Registers a function to directly modify the Webpack configuration object (when Webpack is used as the bundler).

-   **Type:**  `api.modifyWebpackConfig(modifyFn: (config: WebpackConfig, utils: WebpackUtils) => WebpackConfig | Promise<WebpackConfig> | void)`
-   **Parameters:**
    -   `modifyFn`: A modification function that receives the Webpack configuration object and utility functions as parameters. It can return a modified configuration object, a Promise, or nothing (modifying the original object directly).
-   **Execution Phase:** When generating the final Webpack configuration.
-   **Example:**

```typescript
api.modifyWebpackConfig((config, utils) => {
  // Disable source maps
  config.devtool = false;
});
```

**Build Configuration Modification Order:**

-   **Rsbuild Projects**:
    ```
    modifyRsbuildConfig
    modifyBundlerChain
    tools.bundlerChain
    modifyRspackConfig
    tools.rspack
    ```
-   **Webpack Projects**:
    ```
    modifyBundlerChain
    tools.bundlerChain
    modifyWebpackChain
    tools.webpackChain
    modifyWebpackConfig
    tools.webpack
    ```

---

#### `api.modifyServerRoutes`

Registers a function to modify the server route configuration.

- **Type:** `api.modifyServerRoutes(transformFn: (routes: ServerRoute[]) => ServerRoute[])`
- **Parameters:**
  - `transformFn`: A transformation function that receives the current server route array as a parameter and returns the modified array.
- **Execution Phase:** Before generating the server route file (during the `prepare` phase).
- **Example:**

```typescript
api.modifyServerRoutes(routes => {
  // Add a new API route
  routes.push({
    route: '/api/my-endpoint',
    method: 'GET',
    handler: require.resolve('./api/my-endpoint'),
  });
  return routes;
});
```

---

#### `api.modifyHtmlPartials`

Registers a function to modify HTML template partials.

- **Type:** `api.modifyHtmlPartials(modifyFn: (partials: HtmlPartials, entrypoint: Entrypoint) => void)`
- **Parameters:**
  - `modifyFn`: A modification function that receives the HTML template partials object and the current entry point information as parameters.
    - `partials`: Contains `top`, `head`, and `body` sections. Each section has `append`, `prepend`, and `replace` methods.
- **Execution Phase:** Before generating the HTML file (during the `prepare` phase).
- **Example:**

```typescript
api.modifyHtmlPartials(({ entrypoint, partials }) => {
  // Add a meta tag to the <head> of all pages
  if (partials.head && partials.head.append) {
      partials.head.append(`<meta name="my-custom-meta" content="value">`);
  }
});
```

---

### Build Process Control

#### `api.onPrepare`

Registers a hook function to be executed during the Modern.js preparation phase.

-   **Type:** `api.onPrepare(prepareFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `prepareFn`: A preparation function, without parameters, can be asynchronous.
-   **Execution Phase:** After Modern.js has completed configuration validation.
-   **Example:**

```typescript
api.onPrepare(async () => {
  // Perform some initialization operations, such as checking the environment, downloading dependencies, etc.
  await prepareMyCustomEnvironment();
});
```

---

#### `api.addCommand`

Registers a function to add custom CLI commands.

-   **Type:** `api.addCommand(commandFn: ({ program: Command }) => void)`
-   **Parameters:**
    -   `commandFn`: Receives the `program` object from `commander` as a parameter, used to define new commands.
-   **Execution Phase:** After the `prepare` hook has completed.
-   **Example:**

```typescript
api.addCommand(({ program }) => {
  program
    .command('my-command')
    .description('My custom command')
    .action(async () => {
      // Execute command logic
      console.log('Executing custom command...');
    });
});
```

---

#### `api.addWatchFiles`

Registers a function to add additional files to the watch list (for development mode).

-   **Type:** `api.addWatchFiles(watchFn: () => string[] | { files: string[]; isPrivate: boolean; })`
-   **Parameters:**
    -   `watchFn`: Returns an array of file paths or an object containing `files` and `isPrivate` properties.
        -   `files`: An array of file paths to watch.
        -   `isPrivate`: Whether the files are internal to the framework (affects behavior when files change).
-   **Execution Phase:** After the `addCommand` hook has completed.
-   **Example:**

```typescript
api.addWatchFiles(() => {
  // Watch the .env file in the project root directory
  return [path.resolve(api.getAppContext().appDirectory, '.env')];
});
```

---

#### `api.onFileChanged`

Registers a hook function to be executed when a watched file changes (for development mode).

-   **Type:** `api.onFileChanged(changeFn: (params: { filename: string; eventType: 'add' | 'change' | 'unlink'; isPrivate: boolean; }) => void)`
-   **Parameters:**
    -   `changeFn`: A file change handler function that receives the following parameters:
        -   `filename`: The path to the changed file.
        -   `eventType`: The type of change (`add`, `change`, or `unlink`).
        -   `isPrivate`: Whether the changed file is internal to the framework.
-   **Execution Phase:** When a watched file changes.
-   **Example:**

```typescript
api.onFileChanged(({ filename, eventType }) => {
  if (eventType === 'change' && filename.endsWith('.env')) {
    console.log('.env file changed, restarting server...');
    // Restart the development server or perform other actions
  }
});
```

---

#### `api.onBeforeBuild`

Registers a hook function to be executed before the build process starts.

-   **Type:** `api.onBeforeBuild(buildFn: ({ bundlerConfigs }: { bundlerConfigs: RspackConfig[] | WebpackConfig[] }) => void | Promise<void>)`
-   **Parameters:**
    -   `buildFn`: A build preparation function that receives the final bundler configuration array as a parameter.
-   **Execution Phase:** Before the build process starts.
-   **Example:**

```typescript
api.onBeforeBuild(({ bundlerConfigs }) => {
  // Perform pre-build checks or operations, such as linting, code formatting, etc.
  console.log('Starting build with configuration:', bundlerConfigs);
});
```

---

#### `api.onBeforeCreateCompiler`

Registers a hook function to be executed before the bundler compiler instance is created.

- **Type:** `api.onBeforeCreateCompiler(beforeCreateCompilerFn: ({ bundlerConfigs }: { bundlerConfigs: RspackConfig[] | WebpackConfig[] }) => void | Promise<void>)`
- **Parameters:**
  - `beforeCreateCompilerFn`: A function that receives the final bundler configuration array.
- **Execution Phase:** Before creating the bundler compiler.
- **Corresponding Rsbuild Hook**: [beforeCreateCompiler](https://rsbuild.dev/en/plugins/dev/hooks#beforecreatecompiler)
- **Example:**

```typescript
api.onBeforeCreateCompiler(({ bundlerConfigs }) => {
  // You can perform final checks on the configuration here,
  // but avoid modifying the configuration at this stage.
  console.log('Bundler configurations before compiler creation:', bundlerConfigs);
});
```

---

#### `api.onAfterCreateCompiler`

Registers a hook function to be executed after the bundler compiler instance is created.

-   **Type:** `api.onAfterCreateCompiler(afterCreateCompilerFn: ({ compiler }: { compiler: Compiler | MultiCompiler }) => void | Promise<void>)`
-   **Parameters:**
    -   `afterCreateCompilerFn`: A function that receives the bundler compiler instance.
-   **Execution Phase:** After creating the bundler compiler.
-   **Corresponding Rsbuild Hook**: [afterCreateCompiler](https://rsbuild.dev/en/plugins/dev/hooks#aftercreatecompiler)
-   **Example:**

```typescript
api.onAfterCreateCompiler(({ compiler }) => {
  // Add custom webpack/rspack plugins
  if (compiler.constructor.name === 'Compiler') {
      // Single compiler (webpack or rspack)
      new MyCustomWebpackPlugin().apply(compiler);
  } else {
      // MultiCompiler (webpack)
      compiler.compilers.forEach(childCompiler => {
        new MyCustomWebpackPlugin().apply(childCompiler);
      });
  }
});
```

---

#### `api.onBeforeStartDevServer`

Registers a hook function to be executed before the development server starts.

-   **Type:** `api.onBeforeStartDevServer(beforeStartDevServerFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `beforeStartDevServerFn`: A function without parameters.
-   **Execution Phase:** Before starting the development server.
-   **Example:**

```typescript
api.onBeforeStartDevServer(() => {
  // Perform operations before starting the server, such as setting up proxy rules, etc.
  console.log('Preparing to start the development server...');
});
```

---

#### `api.onDevServerReady`

Registers a hook function to be executed after the development server is ready.

-   **Type:** `api.onDevServerReady(devServerReadyFn: ({ port }: { port: number }) => void | Promise<void>)`
-   **Parameters:**
    -   `devServerReadyFn`: A function that receives the development server port number as a parameter.
-   **Execution Phase:** After the development server is ready.
-   **Example:**

```typescript
api.onDevServerReady(({ port }) => {
  console.log(`Development server is running on port ${port}`);
});
```

---

#### `api.onAfterStartDevServer`

Registers a hook function to be executed after the development server has started.

-   **Type:** `api.onAfterStartDevServer(afterStartDevServerFn: ({ port }: { port: number }) => void | Promise<void>)`
-   **Parameters:**
    -   `afterStartDevServerFn`: A function that receives the development server port number as a parameter.
-   **Execution Phase:** After starting the development server.
-   **Example:**

```typescript
api.onAfterStartDevServer(({ port }) => {
  // Perform operations after the server starts, such as opening the browser, etc.
  console.log(`Server started successfully. Access it at http://localhost:${port}`);
});
```

---

#### `api.onBeforeStartProdServer`

Registers a hook function to be executed before the production server starts (after running `start` command).

-   **Type:** `api.onBeforeStartProdServer(beforeStartProdServerFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `beforeStartProdServerFn`: A function without parameters.
-   **Execution Phase:** Before starting the production server.
-   **Example:**

```typescript
api.onBeforeStartProdServer(() => {
  console.log('Preparing to start the production server...');
});
```

---
#### `api.onAfterStartProdServer`

Registers a hook function to be executed after the production server has started (after running `start` command).

-   **Type:** `api.onAfterStartProdServer(afterStartProdServerFn: ({ port }: { port: number }) => void | Promise<void>)`
-   **Parameters:**
    -   `afterStartProdServerFn`:  A function that receives the production server port number as a parameter.
-   **Execution Phase:** After starting the production server.
-   **Example:**

```typescript
api.onAfterStartProdServer(({ port }) => {
  console.log(`Production server started successfully. Access it at http://localhost:${port}`);
});
```

---

#### `api.onBeforeBuildProdServer`

Registers a hook function to be executed before building for the production server (before running `start` command).

-   **Type:** `api.onBeforeBuildProdServer(beforeBuildProdServerFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `beforeBuildProdServerFn`: A function without parameters.
-   **Execution Phase:** Before building the production server.
-   **Example:**

```typescript
api.onBeforeBuildProdServer(() => {
  console.log('Building the production server...');
});
```

---

#### `api.onAfterBuildProdServer`

Registers a hook function to be executed after building for the production server (before running `start` command).

-   **Type:** `api.onAfterBuildProdServer(afterBuildProdServerFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `afterBuildProdServerFn`: A function without parameters.
-   **Execution Phase:** After building the production server.
-   **Example:**

```typescript
api.onAfterBuildProdServer(() => {
  console.log('Production server build completed.');
});
```

---

#### `api.onAfterBuild`

Registers a hook function to be executed after the build process is complete.

-   **Type:** `api.onAfterBuild(buildFn: ({ stats }: { stats?: RspackStats | WebpackStats }) => void | Promise<void>)`
-   **Parameters:**
    -   `buildFn`: A build completion function that receives the build statistics object as a parameter.
-   **Execution Phase:** After the build process is complete.
-   **Example:**

```typescript
api.onAfterBuild(({ stats }) => {
  if (stats) {
    console.log(stats.toString()); // Output build statistics
  }
  console.log('Build completed.');
});
```

---

#### `api.onExit`

Registers a hook function to be executed when the Modern.js process is about to exit.

-   **Type:** `api.onExit(exitFn: () => void | Promise<void>)`
-   **Parameters:**
    -   `exitFn`: An exit function, without parameters, can be asynchronous.
-   **Execution Phase:** When the Modern.js process is about to exit (e.g., after a `SIGINT` signal).
-   **Example:**

```typescript
api.onExit(() => {
  // Perform cleanup operations, such as closing database connections, removing temporary files, etc.
  console.log('Exiting Modern.js...');
});
```

---

### Type Definitions

```typescript
// Type definitions (Simplified for clarity.  Refer to the actual source code for complete definitions)

type UserConfig = any; // The actual user configuration type.
type RspackConfig = any; // Rspack configuration type.
type WebpackConfig = any; // Webpack configuration type.
type WebpackChain = any;  // webpack-chain instance type.
type RspackChain = any; // RspackChain instance type.
type RspackUtils = any;  // Rspack utility functions.
type WebpackUtils = any;  // Webpack utility functions.
type ServerRoute = any; // Server route type.
type HtmlPartials = any; // HTML partials type.
type Entrypoint = any;   // Entry point information type.
type RspackStats = any; // Rspack Stats type.
type WebpackStats = any; // Webpack Stats type.
type Compiler = any; // Webpack or Rspack compiler
type MultiCompiler = any; // Webpack MultiCompiler
type RsbuildConfig = any; // Rsbuild config
type RsbuildUtils = any; // Rsbuild utils

interface AppContext {
  // ... (Fields listed in the api.getAppContext section) ...
}

interface CliPluginFuture<T> {
  name: string;
  setup: (api: CliPluginAPI<T>) => void;
}

interface CliPluginAPI<T> {
  getAppContext: () => AppContext;
  getConfig: () => UserConfig;
  getNormalizedConfig: () => UserConfig;
  isPluginExists: (pluginName: string) => boolean;
  getHooks: () => any; // Returns an object with all hook functions.

  config: (configFn: () => UserConfig | Promise<UserConfig>) => void;
  modifyBundlerChain: (modifyFn: (chain: WebpackChain | RspackChain, utils: WebpackUtils | RspackUtils) => void | Promise<void>) => void;
  modifyRsbuildConfig: (modifyFn: (config: RsbuildConfig, utils: RsbuildUtils) => RsbuildConfig | Promise<RsbuildConfig> | void) => void;
  modifyRspackConfig: (modifyFn: (config: RspackConfig, utils: RspackUtils) => RspackConfig | Promise<RspackConfig> | void) => void;
  modifyWebpackChain: (modifyFn: (chain: WebpackChain, utils: WebpackUtils) => void | Promise<void>) => void;
  modifyWebpackConfig: (modifyFn: (config: WebpackConfig, utils: WebpackUtils) => WebpackConfig | Promise<WebpackConfig> | void) => void;
  modifyServerRoutes: (transformFn: (routes: ServerRoute[]) => ServerRoute[]) => void;
  modifyHtmlPartials: (modifyFn: (partials: HtmlPartials, entrypoint: Entrypoint) => void) => void;

  onPrepare: (prepareFn: () => void | Promise<void>) => void;
  addCommand: (commandFn: ({ program: any }) => void) => void; // program is a Commander.js Command instance
  addWatchFiles: (watchFn: () => string[] | { files: string[]; isPrivate: boolean; }) => void;
  onFileChanged: (changeFn: (params: { filename: string; eventType: 'add' | 'change' | 'unlink'; isPrivate: boolean; }) => void) => void;
  onBeforeBuild: (buildFn: ({ bundlerConfigs }: { bundlerConfigs: RspackConfig[] | WebpackConfig[] }) => void | Promise<void>) => void;
  onBeforeCreateCompiler: (beforeCreateCompilerFn: ({ bundlerConfigs }: { bundlerConfigs: RspackConfig[] | WebpackConfig[] }) => void | Promise<void>) => void;
  onAfterCreateCompiler: (afterCreateCompilerFn: ({ compiler }: { compiler: Compiler | MultiCompiler }) => void | Promise<void>) => void;
  onBeforeStartDevServer: (beforeStartDevServerFn: () => void | Promise<void>) => void;
  onDevServerReady: (devServerReadyFn: ({ port }: { port: number }) => void | Promise<void>) => void;
  onAfterStartDevServer: (afterStartDevServerFn: ({ port }: { port: number }) => void | Promise<void>) => void;
  onBeforeStartProdServer: (beforeStartProdServerFn: () => void | Promise<void>) => void;
  onAfterStartProdServer: (afterStartProdServerFn: ({ port }: { port: number }) => void | Promise<void>) => void;
  onBeforeBuildProdServer: (beforeBuildProdServerFn: () => void | Promise<void>) => void;
  onAfterBuildProdServer: (afterBuildProdServerFn: () => void | Promise<void>) => void;
  onAfterBuild: (buildFn: ({ stats }: { stats?: RspackStats | WebpackStats }) => void | Promise<void>) => void;
  onExit: (exitFn: () => void | Promise<void>) => void;
}

