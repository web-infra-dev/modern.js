## API Report File for "@modern-js/libuild"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

/// <reference types="less" />
/// <reference types="node" />

import type { AcceptedPlugin } from 'postcss';
import type { BuildOptions } from 'esbuild';
import type CleanCss from 'clean-css';
import { Message as EsbuildError } from 'esbuild';
import { ImportKind } from 'esbuild';
import type { Loader as Loader_2 } from 'esbuild';
import type { Metafile } from 'esbuild';
import type { MinifyOptions } from 'terser';
import type { OnLoadArgs } from 'esbuild';
import type { OnLoadResult } from 'esbuild';
import type { OnResolveArgs } from 'esbuild';
import type { OnResolveResult } from 'esbuild';
import type { Plugin as Plugin_2 } from 'postcss';
import type { ProcessOptions } from 'postcss';
import { TransformOptions } from 'esbuild';
import { URL as URL_2 } from 'url';

// @public (undocumented)
export type Asset = {
    outdir?: string;
    rebase?: boolean;
    name?: string | ((filePath: string) => string);
    limit?: number;
    publicPath?: string | ((filePath: string) => string);
};

// @public (undocumented)
export type AssetChunk = {
    type: 'asset';
    contents: string | Buffer;
    fileName: string;
    originalFileName?: string;
    entryPoint?: string;
};

// @public (undocumented)
export type AssetNormalized = Required<Asset>;

// @public (undocumented)
export interface BuildConfig extends Required<Omit<CLIConfig, 'sideEffects' | 'chunkNames'>> {
    // (undocumented)
    asset: AssetNormalized;
    // (undocumented)
    chunkNames?: string;
    // (undocumented)
    css_resolve: (id: string, dir: string) => string;
    // (undocumented)
    logger: ILogger;
    // (undocumented)
    node_resolve: (id: string, dir: string, kind?: ImportKind) => string;
    // (undocumented)
    resolve: ResolveNormalized;
    // (undocumented)
    sideEffects?: SideEffects;
}

// @public (undocumented)
export interface BuilderResolveOptions {
    // (undocumented)
    importer?: string;
    // (undocumented)
    kind?: ImportKind;
    // (undocumented)
    resolveDir?: string;
    // (undocumented)
    skipSideEffects?: boolean;
}

// @public (undocumented)
export interface BuilderResolveResult {
    // (undocumented)
    external?: boolean;
    // (undocumented)
    path: string;
    // (undocumented)
    sideEffects?: boolean;
    // (undocumented)
    suffix?: string;
}

// @public (undocumented)
export interface CacheValue extends Source {
    // (undocumented)
    originCode: string;
}

// @public (undocumented)
export type Callback = (err?: any) => void;

// @public (undocumented)
export type Chunk = AssetChunk | JsChunk;

// @public (undocumented)
export const enum ChunkType {
    // (undocumented)
    asset = "asset",
    // (undocumented)
    chunk = "chunk"
}

// @public (undocumented)
export interface CLIConfig extends UserConfig {
    configFile?: string;
    root?: string;
}

// @public (undocumented)
export interface CodeFrameFileOption {
    // (undocumented)
    filePath: string;
}

// @public
export interface CodeFrameLineOption {
    // (undocumented)
    filePath: string;
    // (undocumented)
    length?: number;
    // (undocumented)
    lineText: string;
    // (undocumented)
    start?: CodeFramePosition;
}

// @public (undocumented)
export interface CodeFrameNormalOption {
    // (undocumented)
    end?: CodeFramePosition;
    // (undocumented)
    fileContent: string;
    // (undocumented)
    filePath: string;
    // (undocumented)
    start?: CodeFramePosition;
}

// @public (undocumented)
export type CodeFrameOption = CodeFrameFileOption | CodeFrameNormalOption | CodeFrameLineOption;

// @public (undocumented)
export interface CodeFramePosition {
    // (undocumented)
    column?: number;
    // (undocumented)
    line: number;
}

// @public (undocumented)
export function ConfigLoaderMesaageToLibuildError({ message, location }: IConfigLoaderMessage, isError?: boolean): LibuildError;

// @public (undocumented)
export interface ControllerOption {
    noColor?: boolean;
    noStack?: boolean;
}

// @public (undocumented)
export function defineConfig(config: UserConfig): UserConfig;

// @public (undocumented)
export function defineConfig(config: UserConfig[]): UserConfig[];

// @public (undocumented)
export enum ErrorLevel {
    // (undocumented)
    Error = 2,
    // (undocumented)
    Ignore = 0,
    // (undocumented)
    Warn = 1
}

export { EsbuildError }

// @public (undocumented)
export interface EsbuildResultInfo {
    // (undocumented)
    errors: EsbuildError[];
    // (undocumented)
    warnings: EsbuildError[];
}

// @public (undocumented)
export type ExtraContext = Record<string, any>;

// @public (undocumented)
export type Format = 'esm' | 'cjs' | 'umd' | 'iife';

// @public (undocumented)
export function formatError(err: Error | LibuildErrorInstance): string;

// @public (undocumented)
export interface IBuilderBase {
    // (undocumented)
    build(): Promise<void>;
    // (undocumented)
    close(callack?: Callback): void;
    // (undocumented)
    reBuild(type: 'link' | 'change'): Promise<void>;
}

// @public (undocumented)
export interface IConfigLoaderMessage {
    // (undocumented)
    location?: {
        file: string;
        source: string;
        line?: number;
        column?: number;
        length?: number;
    };
    // (undocumented)
    message: string;
}

// @public (undocumented)
export interface IConfigLoaderOptions {
    // (undocumented)
    configFile: string;
    // (undocumented)
    configKey: string;
    // (undocumented)
    configSuffix?: string;
    // (undocumented)
    cwd: string;
    // (undocumented)
    transformOptions?: TransformOptions;
}

// @public (undocumented)
export interface IConfigLoaderResult<T> {
    // (undocumented)
    data: T;
    // (undocumented)
    errors?: IConfigLoaderMessage[];
    // (undocumented)
    path?: string;
    // (undocumented)
    warnings?: IConfigLoaderMessage[];
}

// @public (undocumented)
export interface ILibuilder {
    // (undocumented)
    addWatchFile(id: string): void;
    // (undocumented)
    build(): Promise<void>;
    // (undocumented)
    clearErrors(): void;
    // (undocumented)
    close(callBack?: Callback): Promise<void>;
    // (undocumented)
    compilation: IBuilderBase;
    // (undocumented)
    config: BuildConfig;
    // (undocumented)
    emitAsset(name: string, chunk: AssetChunk): void;
    // (undocumented)
    emitAsset(name: string, chunk: JsChunk): void;
    // (undocumented)
    emitAsset(name: string, chunk: string): void;
    // (undocumented)
    getErrors(): LibuildFailure;
    // (undocumented)
    getSourcemapContext(path: string): ISourcemapContext;
    // (undocumented)
    getTransformContext(path: string): ITransformContext;
    // (undocumented)
    hooks: ILibuilderHooks;
    // (undocumented)
    init(config: CLIConfig): Promise<void>;
    // Warning: (ae-forgotten-export) The symbol "LoadSvgrResult" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    loadSvgr(path: string): Promise<LoadSvgrResult | void>;
    // (undocumented)
    name?: string;
    // (undocumented)
    outputChunk: Map<string, Chunk>;
    // (undocumented)
    plugins: LibuildPlugin[];
    // (undocumented)
    printErrors(): void;
    // (undocumented)
    removeError(...errors: LibuildErrorInstance[]): void;
    // (undocumented)
    report(error: any): void;
    // (undocumented)
    resolve(source: string, options?: BuilderResolveOptions): Promise<BuilderResolveResult>;
    // (undocumented)
    STAGE: ILibuilderStage;
    // (undocumented)
    throw(message: string, option: LibuildErrorParams): void;
    // (undocumented)
    userConfig: CLIConfig;
    // (undocumented)
    version: string;
    // (undocumented)
    virtualModule: Map<string, string>;
    // (undocumented)
    watchedFiles: Set<string>;
}

// @public (undocumented)
export interface ILibuilderHooks {
    endCompilation: AsyncSeriesHook<[LibuildFailure]>;
    // Warning: (ae-forgotten-export) The symbol "AsyncSeriesHook" needs to be exported by the entry point index.d.ts
    initialize: AsyncSeriesHook<[], void>;
    load: AsyncSeriesBailHook<[LoadArgs], LoadResult | undefined | void>;
    processAsset: AsyncSeriesWaterfallHook<[Chunk]>;
    processAssets: AsyncSeriesHook<[Map<string, Chunk>, LibuildManifest]>;
    // Warning: (ae-forgotten-export) The symbol "AsyncSeriesBailHook" needs to be exported by the entry point index.d.ts
    resolve: AsyncSeriesBailHook<[ResolveArgs], ResolveResult | undefined>;
    shutdown: AsyncSeriesHook<[]>;
    startCompilation: AsyncSeriesHook<[]>;
    // Warning: (ae-forgotten-export) The symbol "AsyncSeriesWaterfallHook" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    transform: AsyncSeriesWaterfallHook<Source>;
    // Warning: (ae-forgotten-export) The symbol "SyncHook" needs to be exported by the entry point index.d.ts
    watchChange: SyncHook<[string[]]>;
}

// @public (undocumented)
export interface ILibuilderStage {
    POST_INTERNAL: number;
    PRE_INTERNAL: number;
}

// @public (undocumented)
export abstract class ILogger {
    // (undocumented)
    abstract debug(...msg: string[]): void;
    // (undocumented)
    abstract error(...msg: string[]): void;
    // (undocumented)
    abstract info(...msg: string[]): void;
    // (undocumented)
    abstract time(label: Label): void;
    // (undocumented)
    abstract timeEnd(label: Label): void;
    // Warning: (ae-forgotten-export) The symbol "Label" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    abstract timesLog: Map<Label, number>;
    // (undocumented)
    abstract warn(...msg: string[]): void;
}

// @public (undocumented)
export interface ILoggerOptions {
    level?: LogLevel;
    timestamp?: boolean;
}

// @public (undocumented)
export function insertSpace(rawLines: string, line: number, width: number): string;

// @public
export function isLibuildErrorInstance(err: unknown): err is LibuildError;

// @public (undocumented)
export interface ISourcemapContext {
    // (undocumented)
    addSourceMap(pluginId: number, map?: SourceMap): void;
    // (undocumented)
    genPluginId(id: string): number;
    // (undocumented)
    getInlineSourceMap(): string;
    // (undocumented)
    getSourceMap(): SourceMap | undefined;
    // (undocumented)
    getSourceMapChain(): SourceMap[];
}

// @public (undocumented)
export interface ITransformContext extends ISourcemapContext {
    // (undocumented)
    addTransformResult(pluginId: number, result: CacheValue): void;
    // (undocumented)
    getValidCache(pluginId: number, code: string): undefined | CacheValue;
}

// @public (undocumented)
export type JsChunk = {
    type: 'chunk';
    contents: string;
    fileName: string;
    originalFileName?: string;
    map?: SourceMap;
    entryPoint?: string;
    modules?: Record<string, any>;
    isEntry: boolean;
};

// @public (undocumented)
export class Libuilder implements ILibuilder {
    // (undocumented)
    addWatchFile(id: string): void;
    // (undocumented)
    build(): Promise<void>;
    // (undocumented)
    clearErrors(): void;
    // (undocumented)
    close(callback?: Callback): Promise<void>;
    // (undocumented)
    compilation: IBuilderBase;
    // (undocumented)
    config: BuildConfig;
    // (undocumented)
    static create(config?: CLIConfig, name?: string): Promise<Libuilder>;
    // (undocumented)
    emitAsset(name: string, chunk: string | Chunk): void;
    // (undocumented)
    getErrors(): LibuildFailure;
    // Warning: (ae-forgotten-export) The symbol "SourcemapContext" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    getSourcemapContext(path: string): SourcemapContext;
    // Warning: (ae-forgotten-export) The symbol "TransformContext" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    getTransformContext(path: string): TransformContext;
    // (undocumented)
    hooks: ILibuilderHooks;
    // (undocumented)
    init(config: CLIConfig): Promise<void>;
    // (undocumented)
    loadSvgr(path: string): Promise<void>;
    // (undocumented)
    name?: string;
    // (undocumented)
    outputChunk: Map<string, Chunk>;
    // (undocumented)
    plugins: LibuildPlugin[];
    // (undocumented)
    printErrors(): void;
    // (undocumented)
    removeError(...errors: LibuildError[]): void;
    // (undocumented)
    report(err: any): void;
    // (undocumented)
    resolve(source: string, opt: BuilderResolveOptions): Promise<BuilderResolveResult>;
    // (undocumented)
    static run(config?: CLIConfig, name?: string): Promise<Libuilder | Libuilder[]>;
    // (undocumented)
    STAGE: ILibuilderStage;
    // (undocumented)
    throw(message: string, opts?: LibuildErrorParams): void;
    // (undocumented)
    userConfig: CLIConfig;
    // (undocumented)
    version: string;
    // (undocumented)
    virtualModule: Map<string, string>;
    // (undocumented)
    watchedFiles: Set<string>;
}

// @public (undocumented)
export class LibuildError extends Error implements LibuildErrorInstance {
    constructor(code: string, message: string, opts?: LibuildErrorParams);
    // (undocumented)
    readonly code: string;
    // (undocumented)
    static from(err: unknown, opt?: LibuildErrorParams): LibuildError;
    // (undocumented)
    readonly hint?: string;
    // (undocumented)
    isSame(error: LibuildError): boolean;
    // (undocumented)
    get level(): "Ignore" | "Warn" | "Error";
    // (undocumented)
    get path(): string | undefined;
    set path(file: string | undefined);
    // (undocumented)
    readonly prefixCode: string;
    // (undocumented)
    readonly reason?: string;
    // (undocumented)
    readonly referenceUrl?: string;
    // (undocumented)
    setCodeFrame(opt: CodeFrameOption): void;
    // (undocumented)
    setControllerOption(opt: ControllerOption): void;
    // (undocumented)
    toString(): string;
}

// @public (undocumented)
export interface LibuildErrorInstance {
    // (undocumented)
    code: string;
    // (undocumented)
    hint?: string;
    level?: keyof typeof ErrorLevel;
    // (undocumented)
    message: string;
    // (undocumented)
    path?: string;
    // (undocumented)
    prefixCode?: string;
    // (undocumented)
    reason?: string;
    // (undocumented)
    referenceUrl?: string;
    // (undocumented)
    setCodeFrame(opt: CodeFrameOption): void;
    // (undocumented)
    setControllerOption(opt: ControllerOption): void;
    // (undocumented)
    stack?: string;
}

// @public (undocumented)
export type LibuildErrorParams = Omit<LibuildErrorInstance, 'code' | 'message' | 'path' | 'setControllerOption' | 'setCodeFrame' | 'toOverlayPayload'> & {
    code?: string;
    controller?: ControllerOption;
    codeFrame?: CodeFrameOption;
};

// @public (undocumented)
export class LibuildFailure extends Error {
    constructor(errors: LibuildErrorInstance[], warnings: LibuildErrorInstance[], logLevel: string);
    // (undocumented)
    readonly errors: LibuildErrorInstance[];
    // (undocumented)
    readonly logLevel: string;
    // (undocumented)
    toString(): string;
    // (undocumented)
    readonly warnings: LibuildErrorInstance[];
}

// @public (undocumented)
export type LibuildManifest = {
    metafile: Metafile;
    config: BuildOptions;
};

// @public (undocumented)
export interface LibuildPlugin<T extends ExtraContext = ExtraContext> {
    // (undocumented)
    apply(compiler: SafeMerge<ILibuilder, T>): void;
    // (undocumented)
    name: string;
}

// @public (undocumented)
export type LoadArgs = Pick<OnLoadArgs, 'path'> & Pick<OnResolveResult, 'pluginData'>;

// @public (undocumented)
export function loadConfig(config: CLIConfig): Promise<CLIConfig | CLIConfig[]>;

// @public (undocumented)
export function loadRawConfig<T = Record<string, unknown>>(opts: IConfigLoaderOptions): Promise<IConfigLoaderResult<T>>;

// @public (undocumented)
export type LoadResult = Pick<OnLoadResult, 'contents' | 'loader' | 'resolveDir'> & {
    map?: SourceMap;
};

// @public
export type LogLevel = 'silent' | 'error' | 'warning' | 'info' | 'debug' | 'verbose';

// @public (undocumented)
export type PostcssOptions = {
    processOptions?: ProcessOptions;
    plugins?: AcceptedPlugin[];
};

// @public (undocumented)
export type Redirect = {
    alias?: boolean;
    style?: boolean;
    asset?: boolean;
};

// @public
export type Resolve = {
    alias?: Record<string, string>;
    mainFields?: string[];
    mainFiles?: string[];
    preferRelative?: boolean;
};

// @public (undocumented)
export type ResolveArgs = Pick<OnResolveArgs, 'importer' | 'path' | 'resolveDir' | 'kind'>;

// @public (undocumented)
export type ResolveNormalized = Required<Resolve>;

// @public (undocumented)
export type ResolveResult = Pick<OnResolveResult, 'path' | 'external' | 'namespace' | 'sideEffects' | 'suffix'>;

// @public (undocumented)
function run_2(userArgs?: string[]): Promise<void>;
export { run_2 as run }

// @public
export type SafeMerge<T, U> = T & {
    [K in keyof U as Exclude<K, keyof T>]: U[K];
};

// @public (undocumented)
export interface sassOptions {
    data?: string | undefined;

    file?: string | undefined;

    functions?: { [key: string]: (...args: types.SassType[]) => types.SassType | void } | undefined;

    // Warning: (ae-forgotten-export) The symbol "Importer" needs to be exported by the entry point index.d.ts
    importer?: Importer | Importer[] | undefined;

    includePaths?: string[] | undefined;

    indentedSyntax?: boolean | undefined;

    indentType?: 'space' | 'tab' | undefined;

    indentWidth?: number | undefined;

    linefeed?: 'cr' | 'crlf' | 'lf' | 'lfcr' | undefined;

    // Warning: (ae-forgotten-export) The symbol "Logger" needs to be exported by the entry point index.d.ts
    logger?: Logger;

    omitSourceMapUrl?: boolean | undefined;

    outFile?: string | undefined;

    outputStyle?: 'compressed' | 'expanded' | undefined;

    quietDeps?: boolean;

    sourceMap?: boolean | string | undefined;

    sourceMapContents?: boolean | undefined;

    sourceMapEmbed?: boolean | undefined;

    sourceMapRoot?: string | undefined;

    verbose?: boolean;
}

// @public (undocumented)
export type SideEffects = RegExp[] | boolean | ((id: string, external: boolean) => boolean);

// @public (undocumented)
export type Source = {
    code: string;
    map?: SourceMap;
    path: string;
    loader?: string;
    cache?: boolean;
};

// @public (undocumented)
export interface SourceMap {
    // (undocumented)
    mappings: string;
    // (undocumented)
    names: string[];
    // (undocumented)
    sources: (string | null)[];
    // (undocumented)
    sourcesContent?: (string | null)[];
    // (undocumented)
    version: number;
}

// @public (undocumented)
export interface Style {
    // (undocumented)
    autoModules?: boolean | RegExp;
    // (undocumented)
    cleanCss?: CleanCss.OptionsOutput | boolean;
    // (undocumented)
    inject?: boolean;
    // (undocumented)
    less?: {
        additionalData?: AdditionalData;
        implementation?: object | string;
        lessOptions?: Less.Options;
    };
    // (undocumented)
    modules?: {
        localsConvention?: 'camelCase' | 'camelCaseOnly' | 'dashes' | 'dashesOnly' | LocalsConventionFunction;
        scopeBehaviour?: 'global' | 'local';
        globalModulePaths?: RegExp[];
        generateScopedName?: string | GenerateScopedNameFunction;
        hashPrefix?: string;
        exportGlobals?: boolean;
        root?: string;
        resolve?: (file: string) => string | Promise<string>;
        Loader?: typeof Loader;
        getJSON?(cssFilename: string, json: {
            [name: string]: string;
        }, outputFilename?: string): void;
    };
    // (undocumented)
    postcss?: PostcssOptions;
    // (undocumented)
    sass?: {
        additionalData?: AdditionalData;
        implementation?: object | string;
        sassOptions?: sassOptions;
    };
}

// @public (undocumented)
export function toLevel(level: keyof typeof ErrorLevel): ErrorLevel;

// @public (undocumented)
export function transform(err: any, opt?: LibuildErrorParams): LibuildError;

// @public (undocumented)
export interface UserConfig {
    asset?: Asset;
    autoExternal?: boolean | {
        dependencies?: boolean;
        peerDependencies?: boolean;
    };
    bundle?: boolean;
    // (undocumented)
    chunkNames?: string;
    clean?: boolean;
    // Warning: (ae-forgotten-export) The symbol "Define" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    define?: Define;
    // (undocumented)
    entryNames?: string;
    esbuildOptions?: (options: BuildOptions) => BuildOptions;
    // Warning: (ae-forgotten-export) The symbol "External" needs to be exported by the entry point index.d.ts
    external?: External_2;
    format?: Format;
    // Warning: (ae-forgotten-export) The symbol "Globals" needs to be exported by the entry point index.d.ts
    globals?: Globals;
    // (undocumented)
    inject?: string[];
    // Warning: (ae-forgotten-export) The symbol "Input" needs to be exported by the entry point index.d.ts
    input?: Input;
    // (undocumented)
    jsx?: 'automatic' | 'preserve' | 'transform';
    // (undocumented)
    loader?: Record<string, Loader_2>;
    logLevel?: LogLevel;
    metafile?: boolean;
    // Warning: (ae-forgotten-export) The symbol "Minify" needs to be exported by the entry point index.d.ts
    minify?: Minify;
    // (undocumented)
    outbase?: string;
    outdir?: string;
    // Warning: (ae-forgotten-export) The symbol "Platform" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    platform?: Platform;
    plugins?: LibuildPlugin[];
    redirect?: Redirect;
    resolve?: Resolve;
    sideEffects?: SideEffects;
    sourceDir?: string;
    // Warning: (ae-forgotten-export) The symbol "SourceMap" needs to be exported by the entry point index.d.ts
    sourceMap?: SourceMap_2;
    splitting?: boolean;
    style?: Style;
    target?: string;
    transformCache?: boolean;
    watch?: boolean;
}

// @public (undocumented)
export function validateUserConfig(config: UserConfig): void;

// @public (undocumented)
export function warpErrors(libuildErrors: LibuildError[], logLevel?: LogLevel): LibuildFailure;

// Warnings were encountered during analysis:
//
// /Users/bytedance/modern.js/node_modules/.pnpm/@types+sass@1.43.1/node_modules/@types/sass/index.d.ts:53:19 - (ae-forgotten-export) The symbol "types" needs to be exported by the entry point index.d.ts
// src/types/config/style.ts:29:5 - (ae-forgotten-export) The symbol "AdditionalData" needs to be exported by the entry point index.d.ts
// src/types/config/style.ts:41:5 - (ae-forgotten-export) The symbol "LocalsConventionFunction" needs to be exported by the entry point index.d.ts
// src/types/config/style.ts:44:5 - (ae-forgotten-export) The symbol "GenerateScopedNameFunction" needs to be exported by the entry point index.d.ts
// src/types/config/style.ts:49:5 - (ae-forgotten-export) The symbol "Loader" needs to be exported by the entry point index.d.ts

// (No @packageDocumentation comment for this package)

```
